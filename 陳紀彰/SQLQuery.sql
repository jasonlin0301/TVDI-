create database mydb
go
USE MyDB
CREATE TABLE [TBL_1](
	[COL1] [nvarchar](50) NOT NULL,
	timestamp,
    [COL2] [uniqueidentifier] NOT NULL DEFAULT NEWID()    
) ON [PRIMARY]
CREATE TABLE [TBL_2](
	[COL1] [nvarchar](50) NOT NULL,
	[COL2] rowversion,
    [COL3] [uniqueidentifier] NOT NULL DEFAULT NEWID()    
) ON [PRIMARY]

go


INSERT INTO TBL_1 (COL1) VALUES ('12345')
INSERT INTO TBL_2 (COL1) VALUES ('12345')
go

SELECT * from TBL_1
SELECT * from TBL_2
go 

UPDATE TBL_1 SET COL1='123456789' WHERE COL1='12345'
UPDATE TBL_2 SET COL1='123456789' WHERE COL1='12345'
SELECT * from TBL_1
SELECT * from TBL_2

drop table tbl_1
drop table tbl_2


--sql_variant型態
USE MyDB
CREATE TABLE [TBL_3](
	[COL1] [int] IDENTITY(1,1) NOT NULL,
	[COL2] [sql_variant] NOT NULL
) ON [PRIMARY]

INSERT INTO TBL_3 (COL2) VALUES ('資料存檔')
INSERT INTO TBL_3 (COL2) VALUES (N'資料存檔')
INSERT INTO TBL_3 (COL2) VALUES (100.33)
INSERT INTO TBL_3 (COL2) VALUES ('12/12/2007 13:13:13.000')
INSERT INTO TBL_3 (COL2) VALUES (CAST('12/12/2007 13:13:13.000' AS DATETIME))
SELECT * from TBL_3
SELECT SQL_VARIANT_PROPERTY(COL2,'BaseType') 基本資料型態,
	   SQL_VARIANT_PROPERTY(COL2,'PRECISION') 精確度
FROM TBL_3